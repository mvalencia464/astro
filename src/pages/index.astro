---

// import { mapAssetUrl } from '../utils/assetMapper'; // mapAssetUrl now returns metadata object, not just string
// const testPath = 'portfolio/001-aerial-wraparound.webp';
// const result = mapAssetUrl(testPath);

// console.log('--- DEBUG START ---');
// console.log('Searching for:', testPath);
// console.log('Mapper Result:', result); // This should now display [object Object] for image metadata
// console.log('--- DEBUG END ---');


import { Image } from 'astro:assets';
import BaseLayout from '../layouts/BaseLayout.astro';
import { ArrowRight, Phone, Star, Shield, Hammer } from 'lucide-react';
import Header from '../components/Header';
import Footer from '../components/Footer.astro';

// React components (marked for client-side rendering)
import QuoteForm from '../components/QuoteForm';
import TestimonialRotator from '../components/TestimonialRotator';
import PortfolioGrid from '../components/PortfolioGrid';
import ReviewsGridWithModal from '../components/ReviewsGridWithModal';
import ProcessSection from '../components/ProcessSection';
import StickyMobileCTA from '../components/StickyMobileCTA';

// Data
import testimonialsData from '../data/testimonials.json';

// Assets
import heroImage from '../assets/hero/002-aerial-overview.webp';

// Page metadata
const title = 'DECK MASTERS | Anchorage Premium Decks';
const description = 'Expert deck builders in Anchorage serving South Anchorage, Hillside & Eagle River. Custom composite & cedar decks engineered for Alaska winters. 25-year warranty. Free quotes.';
---

<BaseLayout title={title} description={description}>
  <!-- Header Navigation -->
  <Header client:load />

  {/* Hero Section */}
  <header class="relative min-h-screen flex items-center overflow-hidden pt-24 pb-48 lg:pt-0 lg:pb-0">
    {/* Background Image with Overlay */}
    <div class="absolute inset-0 z-0 bg-stone-900">
      <Image
        src={heroImage}
        alt="Modern Deck in Anchorage"
        class="w-full h-full object-cover opacity-70 scale-105 animate-slow-zoom"
        sizes="(max-width: 640px) 640px, (max-width: 1024px) 1024px, 1440px"
      />
      <div class="absolute inset-0 bg-stone-950/50 mix-blend-multiply"></div>
      <div class="absolute inset-0 bg-gradient-to-b from-stone-950/90 via-stone-950/40 to-stone-950"></div>
    </div>

    <div class="container mx-auto px-6 z-10 relative">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        <div class="max-w-2xl">
          <div class="flex flex-col gap-2 mb-8 animate-fade-in-up">
            <div class="flex items-center gap-4">
              <div class="h-[1px] w-12 bg-orange-600"></div>
              <span class="text-orange-500 font-bold uppercase tracking-[0.3em] text-sm">Anchorage's #1 Rated Deck Builder</span>
            </div>
          </div>

          <h1 class="text-5xl md:text-8xl font-display font-bold leading-[0.9] tracking-tight mb-8 uppercase animate-fade-in-up delay-100">
            Turn Your Backyard <br />
            <span class="text-transparent bg-clip-text bg-gradient-to-r from-stone-100 to-stone-500">Into A Resort.</span>
          </h1>

          <div class="mb-12 animate-fade-in-up delay-200">
            <TestimonialRotator client:load />

            <p class="text-stone-400 text-lg md:text-xl max-w-xl leading-relaxed border-l-2 border-stone-800 pl-6 mt-8">
              Skip the contractor nightmares. Weekly check-ins, transparent pricing, and frost-proof engineering designed for Alaska's climate. Build your 21-day legacy today.
            </p>
          </div>

          <div class="flex flex-col gap-6 animate-fade-in-up delay-300">
            <div class="flex flex-col sm:flex-row gap-6">
              <button
                class="lg:hidden bg-orange-600 text-white px-10 py-4 font-display font-bold uppercase tracking-widest hover:bg-orange-700 transition-all flex items-center justify-center gap-2 group"
              >
                Book Consultation
                <ArrowRight class="w-4 h-4 group-hover:translate-x-1 transition-transform" />
              </button>
            </div>

            <div class="flex items-center gap-3 text-stone-500 text-xs font-bold uppercase tracking-widest flex-wrap">
              <span class="flex items-center gap-1">
                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/google/google-original.svg" alt="Google" class="w-4 h-4 opacity-70" />
                Google Reviews
              </span>
              <span class="w-1 h-1 bg-stone-700 rounded-full"></span>
              <span>#1 Rated in Anchorage</span>
            </div>
          </div>
        </div>

        <div class="hidden lg:block max-w-md justify-self-end w-full relative group">
          <QuoteForm client:load />

          {/* Playful Call-out Arrow */}
          <div class="absolute -left-32 top-10 flex flex-col items-end animate-fade-in-up delay-700 opacity-90 rotate-[-5deg]">
            <span class="font-handwriting text-2xl text-white mb-2 rotate-[-5deg]">Start Your Project Here!</span>
            <svg width="60" height="40" viewBox="0 0 100 60" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-white drop-shadow-md">
              <path d="M5 20C20 15 40 10 60 25C75 35 85 40 95 30M95 30L80 25M95 30L85 45" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </div>

          <div class="flex items-center justify-center gap-3 mt-6">
            <div class="flex gap-1">
              {[...Array(5)].map((_, i) => (
                <Star key={i} class="w-3 h-3 text-orange-500 fill-orange-500" />
              ))}
            </div>
            <span class="text-stone-400 text-xs font-bold uppercase tracking-wider">4.9, 122 Google Reviews</span>
          </div>
        </div>
      </div>
    </div>

    {/* Hero Footer Bar */}
    <div class="absolute bottom-0 left-0 right-0 border-t border-white/10 bg-stone-950/50 backdrop-blur-sm">
      <div class="container mx-auto px-6 py-8 flex flex-col md:flex-row justify-between items-center gap-6 text-stone-400 text-xs uppercase tracking-widest">
        <div class="flex items-center gap-2">
          <Star class="w-4 h-4 text-orange-600 fill-orange-600" />
          <span>#1 Rated in Anchorage</span>
        </div>
        <div class="flex items-center gap-2">
          <Shield class="w-4 h-4 text-orange-600" />
          <span>25 Year Structural Warranty</span>
        </div>
        <div class="flex items-center gap-2">
          <Hammer class="w-4 h-4 text-orange-600" />
          <span>Master Craftsmen Certified</span>
        </div>
      </div>
    </div>

    {/* Sticky Mobile Call Button */}
    <StickyMobileCTA client:load />
  </header>

  {/* Portfolio Grid */}
  <PortfolioGrid client:load />

  {/* Reviews Section */}
  <section id="reviews" class="py-32 bg-stone-950 border-t border-stone-800 relative overflow-hidden">
    {/* Background texture */}
    <div class="absolute inset-0 opacity-[0.03]" style={{ backgroundImage: 'repeating-linear-gradient(45deg, #fff 0, #fff 1px, transparent 0, transparent 50%)', backgroundSize: '20px 20px' }} />

    <div class="container mx-auto px-6 relative z-10">
      {/* Section header */}
      <div class="flex flex-col md:flex-row justify-between items-end mb-16 gap-8">
        <div class="max-w-2xl">
          <div class="flex items-center gap-4 mb-6">
            <div class="h-[1px] w-12 bg-orange-600" />
            <span class="text-orange-500 font-bold uppercase tracking-[0.3em] text-sm">Reviews</span>
          </div>
          <h2 class="text-4xl md:text-7xl font-display font-bold uppercase leading-[1.1] md:leading-[0.95]">
            What Anchorage <br /><span class="text-stone-500">Is Saying.</span>
          </h2>
          <div class="flex items-center gap-4 mt-8">
            <div class="flex gap-1">
              {[...Array(5)].map((_, i) => (
                <Star key={i} class="w-5 h-5 text-orange-500 fill-orange-500" />
              ))}
            </div>
            <span class="text-stone-400 text-sm font-bold uppercase tracking-wider">4.9 Average Â· 122 Google Reviews</span>
          </div>
        </div>
        <a
          href="https://www.google.com/maps/search/Deck+Masters+AK+Anchorage+reviews"
          target="_blank"
          rel="noopener noreferrer"
          class="text-stone-500 hover:text-white font-bold uppercase text-xs tracking-widest transition-colors flex items-center gap-2 pb-2 border-b border-stone-800 shrink-0"
        >
          See All Google Reviews <ArrowRight class="w-4 h-4" />
        </a>
      </div>

      <ReviewsGridWithModal client:load testimonialsData={testimonialsData} />

      {/* Bottom CTA */}
      <div class="mt-16 text-center">
        <a
          href="https://www.google.com/maps/search/Deck+Masters+AK+Anchorage"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-3 px-8 py-4 border border-stone-700 text-stone-400 hover:border-orange-600 hover:text-white font-bold uppercase text-xs tracking-widest transition-all duration-300"
        >
          <Star class="w-4 h-4 text-orange-500 fill-orange-500" />
          Leave Us a Review on Google
          <ArrowRight class="w-4 h-4" />
        </a>
      </div>
    </div>
  </section>

  {/* Process Section */}
  <ProcessSection client:load />

  <!-- Footer -->
  <Footer />
</BaseLayout>
